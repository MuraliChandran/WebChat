<div class="wrapper">
  <div class="chat-box" *ngIf="visible" [@fadeInOut]="visible">
    <div class="chat-box-header">
      Chat
    </div>

    <div class="chat-box-main">
      <div class="chat-message-bottom" #bottom></div>
      <ng-container *ngFor="let m of messages">
        <div
          class="chat-message"
          [class.chat-message-received]="m.source === 'received'"
          [@fadeIn]
          [class.chat-message-sent]="m.source === 'sent'"
        >
          <div>
            <app-chat-avatar
              [image]="m.from.avatar"
              class="chat-message-from-avatar"
            ></app-chat-avatar>
            <ng-container
              *ngIf="m.type === 'text'; then disptext; else dispimage"
            >
            </ng-container>

            <ng-template #disptext>
              <div class="chat-message-text">
                {{ m.message }}
              </div>
            </ng-template>

            <ng-template #dispimage>
              <div >
                <img [attr.src]="image" class="chat-message-from-Image" />
              </div>
            </ng-template>
          </div>

          <div class="chat-message-date">
            {{ m.date | date: "short" }}
          </div>
        </div>
      </ng-container>
    </div>

    <div class="chat-box-footer">
      <app-chat-input (send)="sendMessage($event)"></app-chat-input>
    </div>
  </div>

  <button class="chat-button" (click)="toggleChat()">
    <span [@fadeIn] *ngIf="visible">âœ•</span>
    <span [@fadeIn] *ngIf="!visible">@</span>
  </button>
</div>
